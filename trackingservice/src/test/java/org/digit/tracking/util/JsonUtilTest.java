package org.digit.tracking.util;

import org.digit.tracking.data.model.FsmApplication;
import org.junit.Test;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.*;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class JsonUtilTest {
    Logger logger = LoggerFactory.getLogger(JsonUtilTest.class);

    @Test
    public void testJsonStringToObject(){
        String input = "{\"totalCount\":2,\"responseInfo\":{\"apiId\":\"Rainmaker\",\"ver\":null,\"ts\":null,\"resMsgId\":\"uief87324\",\"msgId\":\"1694796531963|en_IN\",\"status\":\"successful\"},\"fsm\":[{\"citizen\":{\"id\":626,\"uuid\":\"a683ed2f-f04f-434b-9218-668f7a52812c\",\"userName\":\"e07ea483-197b-45f6-9384-3ff1d5dcbb6d\",\"name\":\"jkhvjhsjhk\",\"password\":null,\"mobileNumber\":\"6786786788\",\"tenantId\":\"pb\",\"salutation\":null,\"emailId\":null,\"altContactNumber\":null,\"pan\":null,\"aadhaarNumber\":null,\"permanentAddress\":null,\"permanentCity\":null,\"permanentPinCode\":null,\"correspondenceCity\":null,\"correspondencePinCode\":null,\"active\":true,\"dob\":null,\"pwdExpiryDate\":1703154415000,\"locale\":null,\"type\":\"CITIZEN\",\"signature\":null,\"accountLocked\":false,\"roles\":[{\"id\":null,\"name\":\"Citizen\",\"code\":\"CITIZEN\",\"tenantId\":\"pb\"}],\"bloodGroup\":null,\"identificationMark\":null,\"photo\":null,\"createdBy\":\"172\",\"createdDate\":1695378415000,\"lastModifiedBy\":\"172\",\"lastModifiedDate\":1695378415000,\"otpReference\":null,\"gender\":\"MALE\"},\"id\":\"ed229329-2b00-4cb7-aa02-0db7f0803528\",\"tenantId\":\"pb.amritsar\",\"applicationNo\":\"107-FSM-2023-09-22-000323\",\"description\":null,\"accountId\":\"a683ed2f-f04f-434b-9218-668f7a52812c\",\"additionalDetails\":{\"tripAmount\":1000},\"applicationStatus\":\"DSO_INPROGRESS\",\"source\":\"TELEPHONE\",\"sanitationtype\":null,\"propertyUsage\":\"RESIDENTIAL.APARTMENT\",\"vehicleType\":null,\"noOfTrips\":2,\"vehicleCapacity\":\"1000\",\"status\":null,\"vehicleId\":\"2871cf25-0d3b-4844-91b1-02396a3f6147\",\"driverId\":\"ccf4998c-e7af-4e4d-a97f-59c51bbf45e5\",\"vehicle\":null,\"dsoId\":\"f41eaa9e-4dfb-4292-8d00-033d3f847dec\",\"dso\":null,\"possibleServiceDate\":1695427200000,\"pitDetail\":{\"type\":null,\"id\":\"20033f78-b714-4d2c-a8e4-7be39f47f70e\",\"tenantId\":\"pb.amritsar\",\"height\":0.0,\"length\":0.0,\"width\":0.0,\"diameter\":0.0,\"distanceFromRoad\":0.0,\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1695378415200,\"lastModifiedTime\":1695457493309},\"additionalDetails\":null},\"address\":{\"tenantId\":\"pb.amritsar\",\"doorNo\":null,\"plotNo\":null,\"id\":\"50753c67-4366-41b3-be4b-da207f828c06\",\"landmark\":null,\"city\":null,\"district\":null,\"region\":null,\"state\":null,\"country\":null,\"pincode\":\"143001\",\"additionalDetails\":null,\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1695378415200,\"lastModifiedTime\":1695457493309},\"buildingName\":null,\"street\":null,\"slumName\":null,\"locality\":{\"code\":\"SUN04\",\"name\":\"Ajit Nagar - Area1\",\"label\":\"Locality\",\"latitude\":null,\"longitude\":null,\"children\":[],\"materializedPath\":null},\"geoLocation\":{\"id\":\"db43d66a-89ca-472f-84ee-ced406977c92\",\"latitude\":12.9129842,\"longitude\":77.6421466,\"additionalDetails\":null}},\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1695378415200,\"lastModifiedTime\":1695457493309},\"wasteCollected\":null,\"completedOn\":0,\"advanceAmount\":0.00,\"applicationType\":\"Adhoc Service\",\"oldApplicationNo\":null,\"paymentPreference\":null,\"processInstance\":null},{\"citizen\":{\"id\":612,\"uuid\":\"c4c9c063-1258-47a6-b474-3e4cefa95cfc\",\"userName\":\"d847d961-b62d-4544-83a6-3e81a04bc03e\",\"name\":\"NAvya\",\"password\":null,\"mobileNumber\":\"9876543210\",\"tenantId\":\"pb\",\"salutation\":null,\"emailId\":null,\"altContactNumber\":null,\"pan\":null,\"aadhaarNumber\":null,\"permanentAddress\":null,\"permanentCity\":null,\"permanentPinCode\":null,\"correspondenceCity\":null,\"correspondencePinCode\":null,\"active\":true,\"dob\":null,\"pwdExpiryDate\":1695291192000,\"locale\":null,\"type\":\"CITIZEN\",\"signature\":null,\"accountLocked\":false,\"roles\":[{\"id\":null,\"name\":\"Citizen\",\"code\":\"CITIZEN\",\"tenantId\":\"pb\"}],\"bloodGroup\":null,\"identificationMark\":null,\"photo\":null,\"createdBy\":\"172\",\"createdDate\":1694584962000,\"lastModifiedBy\":\"172\",\"lastModifiedDate\":1694584962000,\"otpReference\":null,\"gender\":\"MALE\"},\"id\":\"bff698fe-a4f2-4c9e-98f2-301396704cfb\",\"tenantId\":\"pb.amritsar\",\"applicationNo\":\"107-FSM-2023-09-13-000319\",\"description\":null,\"accountId\":\"c4c9c063-1258-47a6-b474-3e4cefa95cfc\",\"additionalDetails\":{\"tripAmount\":0},\"applicationStatus\":\"DSO_INPROGRESS\",\"source\":\"TELEPHONE\",\"sanitationtype\":null,\"propertyUsage\":\"RESIDENTIAL.INDEPENDENT_HOUSE\",\"vehicleType\":null,\"noOfTrips\":3,\"vehicleCapacity\":\"1000\",\"status\":null,\"vehicleId\":\"2871cf25-0d3b-4844-91b1-02396a3f6147\",\"driverId\":\"ccf4998c-e7af-4e4d-a97f-59c51bbf45e5\",\"vehicle\":null,\"dsoId\":\"f41eaa9e-4dfb-4292-8d00-033d3f847dec\",\"dso\":null,\"possibleServiceDate\":1694736000000,\"pitDetail\":{\"type\":null,\"id\":\"9f356d2d-4793-48b0-9f9d-a1822ce797f8\",\"tenantId\":\"pb.amritsar\",\"height\":0.0,\"length\":0.0,\"width\":0.0,\"diameter\":0.0,\"distanceFromRoad\":0.0,\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1694584962533,\"lastModifiedTime\":1695379051284},\"additionalDetails\":null},\"address\":{\"tenantId\":\"pb.amritsar\",\"doorNo\":null,\"plotNo\":null,\"id\":\"31bdb91d-9cf0-48bd-aaa7-a63d9da10007\",\"landmark\":null,\"city\":\"Amritsar\",\"district\":null,\"region\":null,\"state\":null,\"country\":null,\"pincode\":\"143001\",\"additionalDetails\":null,\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1694584962533,\"lastModifiedTime\":1695379051284},\"buildingName\":null,\"street\":null,\"slumName\":\"SL0001\",\"locality\":{\"code\":\"SUN04\",\"name\":\"Ajit Nagar - Area1\",\"label\":\"Locality\",\"latitude\":null,\"longitude\":null,\"children\":[],\"materializedPath\":null},\"geoLocation\":{\"id\":\"c6bcfa32-ff2b-4d1e-8353-05deb871fd47\",\"latitude\":0.0,\"longitude\":0.0,\"additionalDetails\":null}},\"auditDetails\":{\"createdBy\":\"2788a23b-476c-4235-84fa-b675e28ea465\",\"lastModifiedBy\":\"7fe3c10d-86b4-4aba-adfa-360bcdafe5f1\",\"createdTime\":1694584962533,\"lastModifiedTime\":1695379051284},\"wasteCollected\":null,\"completedOn\":0,\"advanceAmount\":null,\"applicationType\":\"Adhoc Service\",\"oldApplicationNo\":null,\"paymentPreference\":null,\"processInstance\":null}],\"workflow\":null}\n";
        List<FsmApplication> fsmApplicationList = JsonUtil.getFSMObjectFromJson(input);
        assertEquals(2, fsmApplicationList.size());

        for (FsmApplication fsmApplication : fsmApplicationList){
            logger.info(fsmApplication.getApplicationStatus());
            logger.info(fsmApplication.getApplicationNo());
            logger.info(fsmApplication.getDriverId());
            logger.info(fsmApplication.getPickupLocationLatitude());
            logger.info(fsmApplication.getPickupLocationLongitude());
        }
    }
}
